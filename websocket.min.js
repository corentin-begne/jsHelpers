var SocketHelper;!function(){"use strict";SocketHelper=function(e){extendSingleton(SocketHelper),this.token,this.events={onopen:this.connected.bind(this),onerror:this.error.bind(this),onclose:this.disconnected.bind(this),onmessage:this.recv.bind(this)},this.userEvents={},e(this)},SocketHelper.getInstance=function(e){return isDefined(e)?void getSingleton(SocketHelper,e):getSingleton(SocketHelper)},SocketHelper.prototype.init=function(e){function t(){isDefined(n.socket)&&n.socket.close()}function o(e,t){n.socket[e]=t}var n=this;$.each(e,o),$(window).unbind("beforeunload"),$(window).bind("beforeunload",t)},SocketHelper.prototype.send=function(e,t){t=isDefined(t)?t:{},t.token=this.token,this.socket.send({type:e,data:t})},SocketHelper.prototype.connect=function(e){console.log("connecting to socket server ...");try{this.socket=WebSocket(e),this.init(this.events)}catch(t){console.error(t)}},SocketHelper.prototype.recv=function(e){return isDefined(this.userEvents[e.type])?void this.userEvents[e.type](e.data):(console.error("socket event received but not defined",e),!1)},SocketHelper.prototype.connected=function(e){console.log("connected to socket server",e)},SocketHelper.prototype.disconnected=function(){console.error("disconnected from socket server")},SocketHelper.prototype.error=function(){console.error("can't connect to socket server")}}();