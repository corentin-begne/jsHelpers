var WebsocketHelper;!function(){"use strict";WebsocketHelper=function(e){extendSingleton(WebsocketHelper),this.token,this.events={onopen:this.connected.bind(this),onerror:this.error.bind(this),onclose:this.disconnected.bind(this),onmessage:this.recv.bind(this)},this.userEvents={},e(this)},WebsocketHelper.getInstance=function(e){return isDefined(e)?void getSingleton(WebsocketHelper,e):getSingleton(WebsocketHelper)},WebsocketHelper.prototype.init=function(e){function t(){isDefined(n.socket)&&n.socket.close()}function o(e,t){n.socket[e]=t}var n=this;$.each(e,o),$(window).unbind("beforeunload"),$(window).bind("beforeunload",t)},WebsocketHelper.prototype.send=function(e,t){t=ifNull(t,{}),t.token=this.token,this.socket.send({type:e,data:t})},WebsocketHelper.prototype.connect=function(e){console.log("connecting to socket server ...");try{this.socket=new WebSocket(e),this.init(this.events)}catch(t){console.error(t)}},WebsocketHelper.prototype.recv=function(e){return isDefined(this.userEvents[e.type])?void this.userEvents[e.type](e.data):(console.error("socket event received but not defined",e),!1)},WebsocketHelper.prototype.connected=function(e){console.log("connected to socket server",e)},WebsocketHelper.prototype.disconnected=function(){console.error("disconnected from socket server")},WebsocketHelper.prototype.error=function(){console.error("can't connect to socket server")}}();